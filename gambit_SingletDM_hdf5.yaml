# Minimal GAMBIT DarkBit test initialization file (in YAML)

###################################
# Input parameter declarations
###################################

Parameters:
    StandardModel_SLHA2: !import StandardModel_SLHA2_SingletDM_scan.yaml

    StandardModel_Higgs:
      mH:
            #fixed_value: 125.7
            range: [124.9, 126.5] # 2-sigma range PDG 2015
            prior_type: flat

    SingletDM:
        mS:
            range: [45., 10000.]
            prior_type: log
        lambda_hS:
            range: [0.001, 1.00]
            #fixed_value: 0.0366524
            prior_type: log

#    nuclear_params_fnq:
#      # proton hadronic matrix elements
#      fpd:
#        fixed_value: 0.0191
#      fpu:
#        fixed_value: 0.0153
#      fps:
#        fixed_value: 0.0447
#      # neutron hadronic matrix elements
#      fnd:
#        fixed_value: 0.0273
#      fnu:
#        fixed_value: 0.011
#      fns:
#        fixed_value: 0.0447
#      # proton spin content
#      deltad:
#        fixed_value: -0.427
#      deltau:
#        fixed_value: 0.842
#      deltas:
#        fixed_value: -0.085

#    nuclear_params_sigma0_sigmal:
#      sigma0:
#        fixed_value: 30.76
#      sigmal:
#        fixed_value: 34.0
#      # proton spin content
#      deltad:
#        fixed_value: -0.427
#      deltau:
#        fixed_value: 0.842
#      deltas:
#        fixed_value: -0.085

    nuclear_params_sigmas_sigmal:
      sigmas:
        #fixed_value: 42.0 # From MicrOmegas?
        range: [27.0, 59.0] # 2 sigma range from Cline et. al.
        prior_type: flat
      sigmal:
        #fixed_value: 34.0 # From MicrOmegas?
        range: [40.0, 76.0] # 2 sigma range from Cline et. al.
        prior_type: flat
      # proton spin content
      deltad:
        fixed_value: -0.427
      deltau:
        fixed_value: 0.842
      deltas:
        fixed_value: -0.085

    LocalHalo:
      rho0: # Local dark matter density
        #fixed_value: .4 # GeV/cm^3
        range: [.2, .8]
        prior_type: flat
      vrot: # Local disk rotation speed
        fixed_value: 235 # km/s
      v0: # Maxwellian most-probable speed
        fixed_value: 235 # km/s
      vesc: # Local galactic escape speed
        fixed_value: 550 # km/s
      vearth: # Keplerian velocity of the earth around the sun
        fixed_value: 29.78 # km/s

#   Uncomment the below to use DarkSUSY nuclear parameters.
#    nuclear_params_fnq: !import NuclearParams_fnq_DarkSUSY.yaml


##############################
# Prior setup
##############################

Priors:


##############################
# Printer setup
##############################

Printer:

  # Select printer to use via string tag
  # (currently only ascii printer available)
  printer: hdf5

  # This options node is passed on wholesale to
  # the printer object; required options may
  # therefore vary according to the selected
  # printer.
  options:
    # name of output file
    output_file: "gambit_output.hdf5"
    group: "/sing/let"
    delete_file_if_exists: true


##############################
# Scanner setup
##############################

Scanner:
  use_scanner: square_grid

  scanners:
    square_grid:
      plugin: square_grid
      version: ">=1.0"
      like: LogLike
      grid_pts: 1 #NxN grid

    multinest:
      plugin: MultiNest
      like:  LogLike
      nlive: 1000
      tol: 0.1
      # No options to set, but still need the nodes at the moment...
      aux_printer_txt_options:
      aux_printer_stats_options:
      aux_printer_live_options:

###############################
# Observables of interest
###############################

ObsLikes:

# Uncomment to run DarkBit unit test
#    - capability: UnitTest_DarkBit
#      purpose:  Observable
#      options:
#        GA_AnnYield:
#          nbins: 20
    - capability: IC79_loglike
      purpose: LogLike

# Fermi LAT dwarf limits
    - capability: lnL_FermiLATdwarfs
      function: lnL_FermiLATdwarfs_gamLike
      purpose:  LogLike
    - capability: lnL_Higgs_invWidth
      purpose: LogLike
# Simple gaussian relic density likelihood
    - capability: RD_oh2
      purpose: Observable
    - capability: lnL_oh2
      purpose: LogLike
      function: lnL_oh2_Simple
# XENON100 2012 direct detection likelihood
    - capability: lnL_XENON100_2012
      purpose: LogLike
# LUX 2013 direct detection likelihood
    - capability: lnL_LUX_2013
      purpose:  LogLike
# DARWIN argon-based proposal (2015 estimate) direct detection likelihood
# NOTE: treated as observable!
#    - capability: lnL_DARWIN_Ar_2015
#      purpose:  Observable
# DARWIN xenon-based proposal (2015 estimate) direct detection likelihood
# NOTE: treated as observable!
#    - capability: lnL_DARWIN_Xe_2015
#      purpose:  Observable

# SM Nuisance Parameter Likelihoods:
# SI nuclear parameters likelihood (only works for nuclear_params_sigmas_sigmal model)
    - capability: lnL_SI_nuclear_parameters
      purpose:  LogLike

# DM Local Density likelihood
    - capability: lnL_rho0
      purpose: LogLike
      
# Charm quark and light quark mass ratio likelihoods
    - capability: lnL_light_quark_masses
      purpose:  LogLike
# G_Fermi likelihood
    - capability: lnL_GF
      purpose:  LogLike
# alpha_s likelihood
    - capability: lnL_alpha_s
      purpose:  LogLike
# HiggsSignals LHC likelihood
    - capability: HS_LHC_lnL
      purpose:  LogLike

Rules:
  # Gamma-rays -------------------------
  - capability: UnitTest_DarkBit
    options:
      GA_AnnYield:
        nbins: 201
  - capability: gamLike_1_0_0_init  # Initialization of gamLike backend
    options:
        # Supply (optional) path to likelihood data.  Otherwise relative path
        # is used.
        # datapath: /home/weniger/Work/Projects/GAMBIT/gambit/extras/gamLike/data/
  - capability: RD_fraction
    function: RD_fraction_from_oh2
  - capability: lnL_FermiLATdwarfs
    #dependencies:
    #    - capability: GA_AnnYield
    #      function: GA_AnnYield_DarkSUSY
  - capability: GA_AnnYield
    #function: GA_AnnYield_DarkSUSY
    function: GA_AnnYield_General
    options:
        Emin: 1.
  - capability: cascadeMC_FinalStates
    options:
        cMC_finalStates:
            - gamma
  - capability: SimYieldTable
    function: SimYieldTable_DarkSUSY
    #function: SimYieldTable_MicrOmegas
  - capability: dump_GammaSpectrum  # For unit tests: dump gamma-ray spectrum
    dependencies:
        - capability: GA_AnnYield
          function: GA_AnnYield_DarkSUSY
    options:
        filename: dNdE.dat

  # Relic density ----------------------
  - capability: RD_oh2
    options:
      fast: 1  # Accuracy options (used by micromegas)
      Beps: 1e-2
    function: RD_oh2_general   # general routines (DS backend)
    #function: RD_oh2_DarkSUSY   # darksusy backend
    #function: RD_oh2_MicrOmegas  # micromegas backend
  - capability: RD_spectrum
    options:
      CoannMaxMass: 1.01 # include only co-annihilating particles up to this mass

#  - capability: RD_thresholds_resonances
#    function: RD_thresholds_resonances_from_spectrum

  - capability: lnL_oh2
    function: lnL_oh2_Simple
    options:
       #oh2_mean: 0.11
       #oh2_err: 0.07

  - capability: RD_fraction
    function: RD_fraction_from_oh2
    options:
      mode: leq_one


  # Direct detection -------------------
  # For MSSM-based models, which of the DarkSUSY or micrOMEGAs routines
  # to use must be explicitly specified here (uncomment the desired one).
  # The SingletDM function can be explicitly specified for the SingletDM
  # model, but the dependency resolver will choose it by default as it
  # is the only one available for that model.
  - capability: DD_couplings
    #function: DD_couplings_DarkSUSY    # couplings from darksusy backend
    #function: DD_couplings_MicrOmegas  # couplings from micromegas backend
    function: DD_couplings_SingletDM   # couplings for singlet DM model
    options:
        rescale_couplings: 1  # For unit tests: rescale couplings
  # Nuclear Parameter Likelihoods (All values in MeV)
  - capability: lnL_SI_nuclear_parameters
    function: lnL_sigmas_sigmal
    options:
      sigmas_central: 43.
      sigmas_error: 8.
      sigmal_central: 58.
      sigmal_error: 9.

  # DM Local Density Likelihood
  - capability: lnL_rho0
    function: lnL_rho0_lognormal
    options:
      rho0_central: 0.4 # GeV/cm^3
      rho0_percentage_error: .3

  # Decays
  - capability: decay_rates
    function: all_decays

  # Precision Bit
  - capability: lnL_light_quark_masses
    options:
      # m_u/m_d
      mud_central: 0.48
      mud_error: 0.10
      # m_s / ((m_u + m_d)/2)
      msud_central: 27.5
      msud_error: 1.0
      # m_s
      ms_central: 95.E-03
      ms_error: 5.E-03

#########################
# Logging setup
#########################

Logger:

  # Redirection of specific messages according to tags
  # Can redirect to stdout or stderr by specifying these as the "filenames".
  # Obviously this also means it is impossible to redirect output to actual
  # files with these names.

  redirection:
    [Debug] : "debug.log"
    [Default] : "default.log"
    [DecayBit] : "DecayBit.log"
    [DarkBit] : "DarkBit.log"
    [PrecisionBit] : "PrecisionBit.log"
    [ColliderBit] : "ColliderrBit.log"
    [SpecBit] : "SpecBit.log"
    [Dependency Resolver] : "dep_resolver.log"

##########################
# Name/Value Section
##########################

KeyValues:

  dependency_resolution:
    prefer_model_specific_functions: true
    use_old_routines: false

  likelihood:
    model_invalid_for_lnlike_below: -1e6
    debug: true

  #By default, errors are fatal and warnings non-fatal
  exceptions:
    dependency_resolver_error: fatal
    dependency_resolver_warning: non-fatal
    core_warning: fatal
    ExampleBit_A_error: non-fatal

  default_output_path: "runs/singletDM_multinest_hdf5/"

  enable_testing: false


