How to build the MicrOmegas Singlet DM model shared library.
by Jonathan Cornell <jcornell@ucsc.edu>

First you need to compile MicrOmegas with the -fPIC flag, if you are using 64-bit Linux and haven’t done so already. To do this:

1. Run make in the $MICROMEGAS root directory. This should generate a $MICROMEGAS/CalcHEP_src/FlagsForSh file

2. Open the $MICROMEGAS/CalcHEP_src/FlagsForSh file and add -fPIC to CFLAGS, CFLAGS, and CXXFLAGS.

3. Run $MICROMEGAS/clean. Answer Y to “Remove all generated files?” but answer N to “remove FlagsForSh?”.

4. Run $MICROMEGAS/make again.

Now you need to create a SingletDM model. To do so,

1. Run $MICROMEGAS/newProject SingletDM.

2. Copy all of the *.mdl files in this directory into $MICROMEGAS/SingletDM/work/models.

3. Run make in $MICROMEGAS/SingletDM

Now to create the shared object that you need for GAMBIT

1. Copy the make_so_micromegas_jc.sh script into $MICROMEGAS/SingletDM

2. Check that the variable definitions at the top of the script are appropriate for your system.

3. Run the script.

4. Move the $MICROMEGAS/SingletDM/lib/libmicromegasSingletDM.so file into $GAMBIT/modules/Backends/lib

5. Add the following lines to $GAMBIT/modules/config/backend_locations.yaml, replacing the version number with the number of the version of MicrOmegas you used:

MicrOmegasSingletDM:
  3.5.5:       ./Backends/lib/libmicromegasSingletDM.so

If any of the above steps don’t work, which wouldn’t surprise me at all, please let me know.

