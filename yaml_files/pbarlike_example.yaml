##########################################################################
## GAMBIT configuration for running a simple random scan of the singlet DM
## model using AMS likelihoods from DarkBit.
##
## Nuisance parameters include the SM Higgs
## mass and the dark matter halo parameters.
##########################################################################


Parameters:

  # SM parameters.
  StandardModel_SLHA2: !import include/StandardModel_SLHA2_defaults.yaml

  # Singlet DM and Higgs parameters
  StandardModel_Higgs:
    mH: 125

  ScalarSingletDM_Z2:
    mS:
      range: [45., 4999.]
      prior_type: log
    lambda_hS:
      range: [0.0001, 10.00]
      prior_type: log

  # Dark matter halo parameters.
  Halo_gNFW_rho0:
    rho0: 0.43
    v0: 235.0
    vesc: 550.0
    vrot: 235.0
    rs: 20.0
    r_sun: 8.5
    alpha: 1
    beta: 3
    gamma: 1


Priors:

  # All priors simple, so specified in Parameters section


Printer:

  printer: hdf5
  options:
    output_file: "ScalarSinglet_Z2.hdf5"
    group: "/ScalarSinglet_Z2"
    delete_file_on_restart: true



Scanner:
 
  use_scanner: random

  scanners:

    random:
      plugin: random
      like: LogLike
      point_number: 1

    square_grid:
      plugin: square_grid
      like: LogLike
      grid_pts: 2

    grid:
      plugin: grid
      like: LogLike
      grid_pts: [1,2]
      # parameters: ["ScalarSingletDM_Z2::mS", "ScalarSingletDM_Z2::lambda_hS"]



ObsLikes:

  - capability: pbar_logLike_uncorr
    purpose: LogLike

  - capability: pbar_logLike_corr
    purpose: Observable

  - capability: sigmav
    purpose: Observable

Rules:

  - capability: TH_ProcessCatalog
    function: TH_ProcessCatalog_ScalarSingletDM_Z2
    dependencies:
      - capability: decay_rates
        function: all_decays
        module: DecayBit

  - capability: RD_fraction
    function: RD_fraction_one

  - capability: pbar_logLikes
    function: lnL_pbarAMS02
    dependencies:
      - capability: RD_fraction
        function: RD_fraction_one
        module: DarkBit


  - capability: pbar_logLike_uncorr
    function: lnL_pbarAMS02_uncorr

  - capability: pbar_logLike_corr
    function: lnL_pbarAMS02_corr

  - function : pbarlike_1_0_init
    options : 
      PreventExtrapolation : False
      PropagationModel : DIFF.BRK
      PropagationParameters : [[0.0]]

  - capability: sigmav
    function: sigmav_late_universe
  


Logger:

  redirection:
    [Default] : "default.log"
    [DarkBit] : "DarkBit.log"
    [Dependency Resolver] : "dep_resolver.log"


KeyValues:

  dependency_resolution:
    prefer_model_specific_functions: true

  likelihood:
    model_invalid_for_lnlike_below: -1e4

  debug: False

  default_output_path: "/formswap/sbalan/samples/ScalarSingletDM_Z2-DarkBit/"
