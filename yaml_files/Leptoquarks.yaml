##########################################################################
## GAMBIT configuration for a Diver scan of the Leptoquark model
##
## Includes likelihood constraints from LHC, precision EW, and dark matter
## observables, with SM and direct detection nuisance parameters.
##########################################################################


Parameters:

  # SM parameters.
  StandardModel_SLHA2: !import include/StandardModel_SLHA2_defaults.yaml

  StandardModel_Higgs:
    mH: 125.09

  Leptoquarks:
    ########
    ## S1 ##
    ########

    # Mass (GeV) 
    MS1: 1000.

    # yLL (S1) Yukawa matrix
    yLLS11x1: 0.1
    yLLS11x2: 0.1
    yLLS11x3: 0.1
    yLLS12x1: 0.1
    yLLS12x2: 0.1
    yLLS12x3: 0.1
    yLLS13x1: 0.1
    yLLS13x2: 0.1
    yLLS13x3: 0.1

    # yRR yukawa matrix
    yRRS11x1: 0.1
    yRRS11x2: 0.1
    yRRS11x3: 0.1
    yRRS12x1: 0.1
    yRRS12x2: 0.1
    yRRS12x3: 0.1
    yRRS13x1: 0.1
    yRRS13x2: 0.1
    yRRS13x3: 0.1

    ########
    ## S3 ##
    ########

    # Mass (GeV) 
    MS3: 1000.

    # yLL (S3) Yukawa matrix
    yLLS31x1: 0.1
    yLLS31x2: 0.1
    yLLS31x3: 0.1
    yLLS32x1: 0.1
    yLLS32x2: 0.1
    yLLS32x3: 0.1
    yLLS33x1: 0.1
    yLLS33x2: 0.1
    yLLS33x3: 0.1

    ########
    ## R2 ##
    ########

    # Mass (GeV) 
    MR2: 1000.

    # yLR yukawa matrix
    yLRR21x1: 0.1 
    yLRR21x2: 0.1
    yLRR21x3: 0.1 
    yLRR22x1: 0.1
    yLRR22x2: 0.1
    yLRR22x3: 0.1
    yLRR23x1: 0.1
    yLRR23x2: 0.1
    yLRR23x3: 0.1

    # yRL yukawa matrix
    yRLR21x1: 0.1
    yRLR21x2: 0.1
    yRLR21x3: 0.1
    yRLR22x1: 0.1
    yRLR22x2: 0.1
    yRLR22x3: 0.1
    yRLR23x1: 0.1
    yRLR23x2: 0.1
    yRLR23x3: 0.1

    ########
    ## U1 ##
    ########

    # Mass (GeV) 
    Mu1: 1000.

    # xL Yukawa matrix
    xLU11x1: 0.1
    xLU11x2: 0.1
    xLU11x3: 0.1
    xLU12x1: 0.1
    xLU12x2: 0.1
    xLU12x3: 0.1
    xLU13x1: 0.1
    xLU13x2: 0.1
    xLU13x3: 0.1

    # xR Yukawa matrix
    xRU11x1: 0.1
    xRU11x2: 0.1
    xRU11x3: 0.1
    xRU12x1: 0.1
    xRU12x2: 0.1
    xRU12x3: 0.1
    xRU13x1: 0.1
    xRU13x2: 0.1
    xRU13x3: 0.1


Priors:

  # All the priors are simple for this scan, so they are specified directly in the Parameters section.


Printer:

  printer: hdf5

  options:
    output_file: "LQs.hdf5"
    group: "/LQs"


Scanner:

  use_scanner: random

  scanners:

    random:
      plugin: random
      point_number: 10
      like:  LogLike

ObsLikes:

  - purpose:      Observable
    capability:   decay_rates
    type:         DecayTable
    printme:      false

  - purpose:      LogLike
    capability:   LHC_Combined_LogLike

Rules:

  # Choose to get cross-sections by Monte Carlo
  - capability: CrossSection
    function: getMCxsec
    module: ColliderBit

  # Globally permit maximal mixing between gauge and family eigenstates
  - options:
      gauge_mixing_tolerance: 0.5
      family_mixing_tolerance: 0.5

  # Choose to get decays from DecayBit proper, not from an SLHA file.
  - capability: decay_rates
    function: all_decays

  # Choose colliders to simulate and their convergence settings, and pick analyses to run with each collider.
  - capability: RunMC
    function: operateLHCLoop
    options:
      silenceLoop: true
      LHC_13TeV:
        min_nEvents: 5000
        max_nEvents: 50000
        events_between_convergence_checks: 5000
        target_fractional_uncert: 0.3
        halt_when_systematic_dominated: true
        all_analyses_must_converge: false
        all_SR_must_converge: false
        maxFailedEvents: 10
        analyses:
          - CMS_13TeV_MONOJET_36invfb

  # Choose Monte Carlo event simulator and options.
  - capability:  HardScatteringSim
    type: ColliderPythia_Leptoquarks_defaultversion
    function: getPythia_Leptoquarks
    options:
      LHC_13TeV:
        # 0.028 fb corresponds to ~1 expected event at L = 36 fb^-1.
        xsec_veto: 0.028
        pythia_settings:
          - Print:quiet = on
          - PartonLevel:MPI = off
          - PartonLevel:ISR = on
          - PartonLevel:FSR = on
          - HadronLevel:all = on
          - LeptoquarksS1:all = on
          - TauDecays:mode = 0
          - TimeShower:pTmin = 2

  # Choose CMS detector simulation and options.
  - capability: CMSDetectorSim
    options:
      LHC_13TeV:
        partonOnly: false
        antiktR: 0.4

  # Choose LHC likelihood form and options.
  - capability: LHC_LogLikes
    backends:
    - {capability: lnlike_marg_poisson_lognormal_error}
    options:
      covariance_marg_convthres_abs: 0.05
      covariance_marg_convthres_rel: 0.05
      covariance_nsamples_start: 100000


Logger:

  redirection:
    [Debug] : "debug.log"
    [Default] : "default.log"
    [DecayBit] : "DecayBit.log"
    [PrecisionBit] : "PrecisionBit.log"
    [ColliderBit] : "ColliderBit.log"
    [SpecBit] : "SpecBit.log"
    [Dependency Resolver] : "dep_resolver.log"

KeyValues:

  dependency_resolution:
    prefer_model_specific_functions: true

  likelihood:
    model_invalid_for_lnlike_below: -5e5
    model_invalid_for_lnlike_below_alt: -1e5

  default_output_path: "runs/LQs/"

  debug: true
