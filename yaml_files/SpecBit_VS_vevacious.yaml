##########################################################################
## GAMBIT configuration for testing vacuum stability likelihood and
## Vevacious interface for the MSSM  (CMSSM by default)
##
##
##   Example file to calculate the vacuum stability of one point using 
##   vevacious. 
##
##   To run this you need to make SpecBit, PrecisionBit as well as the 
##   flexibleSUSY model MSSMatMGUT
##    -> use cmake flag -DBUILD_FS_MODELS="CMSSM;MSSMatMGUT" (can't harm to make
##       the CMSSM)as well.. 
##
##
##########################################################################





Parameters:

  # SM parameters
  StandardModel_SLHA2: !import include/StandardModel_SLHA2_defaults.yaml


  NUHM1:
    # stable point (quick)
    A0: 5476.75
    M0: 402.183
    M12: 4961.51
    SignMu: -1
    TanBeta: 30.49
    mH: 4856.53

    # inconclusive point (takes quite some time..)
    #A0: -8771.05
    #M0: 1703.59
    #M12: 2766.86
    #SignMu: -1
    #TanBeta: 11.9408
    #mH: 4995.75


Printer:

  printer: hdf5
  options:
    output_file: "VS_ouput_test.hdf5"


Scanner:

  
  use_scanner: random

  scanners:
    random:
      plugin: random
      point_number: 1
      like:  LogLike

    toy_mcmc:
      plugin: toy_mcmc
      point_number: 10
      output_file:  output
      like:  Likelihood

    multinest:
      plugin: multinest
      like:  LogLike
      nlive: 10
      tol: 0.1
      updInt: 1

    de:
      plugin: diver
      like: LogLike
      NP: 10
      convthresh: 1e-5
      verbosity: 1



ObsLikes:


  # Vacuum Stability Likelihood using global minimum for tunneling calculation 
  - capability:   VS_likelihood_global
    purpose:      LogLike

  # Vacuum Stability Likelihood using nearest minimum for tunneling calculation 
  - capability:   VS_likelihood_nearest
    purpose:      LogLike

  # print all vevacious results from the 'global' run
  - capability:   VS_results_global
    purpose:      Obs

  # print all vevacious results from the 'nearest' run
  - capability:   VS_results_nearest
    purpose:      Obs


Rules:
  # Tell all functions that are able to dump SLHA files to do so.
  - options:
    drop_SLHA_file: true

  # indicate how often vevacious should be re-run in case of 
  # an inconclusive result
  - capability: check_vacuum_stability_global
    options:
      max_run_trials: 1
  
  - capability: check_vacuum_stability_nearest
    options:
      max_run_trials: 1

  # path to folder were vevacious input files will be saved
  - capability: vevacious_file_location
    options: 
      where_to_save_input: output/Vevacious_iniFiles/

  # pass settings to vevacious
  - capability: init_vevacious
    options:
     tunneling_strategy: QuantumThenThermal
     homotopy_backend: phc
     where_to_save_input: output/Vevacious_iniFiles/
     minuit_strategy: 0
     global_minimum_is_panic: false
     path_finding_timeout: 3600
     radial_resolution_undershoot_overshoot: 0.005
     PathResolution: 500


  # Globally permit maximal mixing between gauge and family eigenstates
  - options:
      gauge_mixing_tolerance: 0.5
      family_mixing_tolerance: 0.5

  
  # Choose to get the spectrum from SpecBit proper, not an SLHA file.
  - capability: unimproved_MSSM_spectrum
    function: get_MSSMatMGUT_spectrum_FS
    options:
      precision_goal:        1.0e-4
      max_iterations:        0
      calculate_sm_masses:   false
      pole_mass_loop_order:  2
      ewsb_loop_order:       2
      beta_loop_order:       2
      threshold_corrections_loop_order: 2
      use_higgs_2loop_at_as: true
      use_higgs_2loop_ab_as: true
      use_higgs_2loop_at_at: true
      use_higgs_2loop_atau_atau: true
      invalid_point_fatal: false

  # Choose where to get the precision spectrum from
  - capability: MSSM_spectrum
    type: Spectrum
    function: make_MSSM_precision_spectrum_4H_W
    
Logger:

  # Select the log files
  redirection:
    [Debug] : "debug.log"
    [Default] : "default.log"
    [SpecBit] : "SpecBit.log"
    [Dependency Resolver] : "dep_resolver.log"


KeyValues:

  # Choose the output path
  default_output_path: "runs/VS_test"

  # Choose to use model spectific funtions during dependency resolution
  dependency_resolution:
    prefer_model_specific_functions: true

  # Choose a lower cutoff for the likelihood
  likelihood:
    model_invalid_for_lnlike_below: -1e6

  debug: true
