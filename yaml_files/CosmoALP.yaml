######################################################
## GAMBIT configuration file for the Cosmo ALP project
##
## Option: Log priors
## 
## \author Tomas Gonzalo
##         (gonzalo@physik.rwth-aachen.de)
##
######################################################


Parameters:

  LCDM_zreio:
    omega_b:
      prior_type: flat
      range: [0.020,0.024]
    omega_cdm:
      prior_type: flat
      range: [0.10,0.13]
    H0:
      prior_type: flat
      range: [62,74]
    T_cmb:
      fixed_value: 2.72548
    z_reio:
      prior_type: flat
      range: [4.5,9.5]

  #PowerLaw_ps:
  #  ln10A_s:
  #    prior_type: flat
  #    range: [2.9,3.2]
  #  n_s:
  #    prior_type: flat
  #    range: [0.9,1.10]
  #  r: 0
  #  N_pivot: 55

  #StandardModel_SLHA2: !import include/StandardModel_SLHA2_Planckbaseline.yaml

  CosmoALP_gg_tau:
    tau:
      range: [1e5, 1e13]
      prior_type: log
    ma0:
      range: [1e3, 1e8]
      prior_type: log
    f0_thermal:
      range: [1e-12, 1e2]
    fa: 1e9
    thetai: 0.0
    T_R: 5.0
    beta: 0.0
    Tchi: 1e99

  cosmo_nuisance_Planck_lite: !import include/Planck_2018/cosmo_nuisance_Planck_lite_flat.yaml

  #cosmo_nuisance_Pantheon:
  #  M:
  #    prior_type: flat
  #    range: [-20,-18]

  nuclear_params_neutron_lifetime:
    neutron_lifetime:
      range: [875,895]

  #rBBN_dNurBBN:
  #  r_BBN: 1.0
  #  dNur_BBN: 0.0

Priors:

Printer:

  printer: cout

  #printer: hdf5
  options:
    output_file: "CosmoALP.hdf5"
    group: "/CosmoALP"
    delete_file_on_restart: false
    buffer_length: 100

Scanner:

  use_scanner: random

  scanners:

    random:
      plugin: random
      point_number: 20
      like:  LogLike

    diver:
      plugin: diver
      like: LogLike
      convthresh: 1e-7
      verbosity: 2
      NP: 20000
      jDE: true
      lambdajDE: false

ObsLikes:

  # ---- BBN -----
  # Likelihood from BBN, including helium3, helium4 and deuterium abundances
  - purpose:      LogLike
    capability:   BBN_LogLike
    sub_capabilities: [He3, He4, D]

  # Print lithium-7 abundance + error (and also He4 and D, as they are used in the likelihood)
  - purpose:      Observable
    capability:   BBN_abundances
    sub_capabilities: [Li7]

  # Print abundances after photodissociation
  - purpose:      Observable
    capability:   BBN_abundances_photodissociation

  # ---- Neutron lifetime -----
  - purpose:      LogLike
    capability:   lnL_neutron_lifetime_bottle

  # ---- CMB -----
  - purpose:      LogLike
    capability:   Planck_nuisance_prior_loglike

  - purpose:      LogLike
    capability:   Planck_highl_loglike
    function:     function_Planck_highl_TTTEEE_lite_2018_loglike

  - purpose:      LogLike
    capability:   Planck_lensing_loglike
    function:     function_Planck_lensing_2018_loglike

  - purpose:      LogLike
    capability:   Planck_lowl_loglike
    function:     function_Planck_lowl_TTEE_2018_loglike


Rules:

  - capability: AlterBBN_Input
    options:
      failsafe: 3
      err: 0

# TODO: Why?
#  - capability: BBN_abundances
#    options:
#      isotope_basis: [Yp, D, He3, Be7, Li7]
#      correlation_matrix: [[+1.000e00, +1.524e-2, +2.667e-2, +2.303e-2, +2.429e-2],
#                           [+1.524e-2, +1.000e00, -8.160e-1, -3.775e-1, -3.653e-1],
#                           [+2.667e-2, -8.160e-1, +1.000e00, +3.897e-1, +3.780e-1],
#                           [+2.303e-2, -3.775e-1, +3.897e-1, +1.000e00, +9.974e-1],
#                           [+2.429e-2, -3.653e-1, +3.780e-1, +9.974e-1, +1.000e00]]
#      relative_errors: [1.348e-3, 1.596e-2, 1.618e-2, 6.788e-2, 6.579e-2]

  - capability: BBN_abundances_photodissociation
    options:
      verbose: false
      NE_pd: 30
      NT_pd: 10
      eps: 1e-1

  - capability: BBN_LogLike
    options:
      DataFile: default.dat

#Likelihoods:

#- SN likelihood

#- HB likelihood

#- FIRAS spectral distortion

#(Bound on reheating temperature implemented by invalidation rather than
#likelihood)

#Observables:

#- ALP-photon coupling

#- ALP abundance

#- PIXIE mock likelihood

Logger:
  redirection:
    [Default]      : "default.log"
    [CosmoBit]     : "CosmoBit.log"
    [DarkBit]      : "DarkBit.log"

KeyValues:

  debug: true

  default_output_path: "runs/CosmoALP"

  likelihood:
    model_invalid_for_lnlike_below: -1e9

