#################################################################################################
# YAML file for testing/debugging the Dirac fermion dark matter model in GAMBIT 1.0.0
# Standard Model, nuclear and halo parameters are same as in https://arxiv.org/abs/1512.06458
# Author: Ankit Beniwal, University of Adelaide
# Email: ankit.beniwal@adelaide.edu.au
# Last modified: Aug, Sep 2017
#################################################################################################

Parameters:

  StandardModel_SLHA2:
    alphainv:  1.279008161E+02 # alpha^{-1}(mZ)^MSbar
    GF      :  1.1663753920E-05 # G_Fermi
    alphaS  :  1.18500000E-01 # alpha_s(mZ)^MSbar
    mZ      :  9.11876000E+01 # mZ(pole)
    mBmB    :  4.18000000E+00 # mb(mb)^MSbar
    mT      :  1.730000E+02 # mtop(pole)
    mTau    :  1.77682000E+00 # mtau(pole)
    mNu3    :               0 # mnu3(pole)
    mE      :  5.10998928E-04 # melectron(pole)
    mNu1    :               0 # mnu1(pole)
    mMu     :  1.05658E-01 # mmuon(pole)
    mNu2    :               0 # mnu2(pole)
    mD      :  4.80000000E-03 # md(2 GeV)^MSbar
    mU      :  2.30000000E-03 # mu(2 GeV)^MSbar
    mS      :  9.50000000E-02 # ms(2 GeV)^MSbar
    mCmC    :  1.27500000E+00 # mc(mc)^MSbar
    CKM_lambda  :  0.22537
    CKM_A       :  0.814
    CKM_rhobar  :  0.117
    CKM_etabar  :  0.353
    theta12 :  0.58376 # solar angle
    theta23 :  0.76958 # atmospheric mixing angle
    theta13 :  0.15495 #
    delta13 :  0       # Dirac CP-violating phase
    alpha1  :  0       # first Majorana CP-violating phase
    alpha2  :  0

  StandardModel_Higgs:
    mH: 125

  DiracDM:
    mF: 250.
    lF: 1e-2
    cosXI: 1.0

  nuclear_params_sigmas_sigmal:
    sigmas: 40
    sigmal: 58
    deltau:  0.842
    deltad:  -0.427
    deltas:  -0.085

  Halo_gNFW_rho0:
    rho0: 0.4
    v0: 220.0
    vrot: 220.0
    vesc: 540.0
    rs: 20.0
    r_sun: 8.5
    alpha: 1
    beta: 3
    gamma: 1

##############################################################################################
Priors:

  # All the priors are simple for this scan, so they are specified directly in the Parameters section.

##############################################################################################
ObsLikes:

    - capability: IC79_loglike
      purpose:    LogLike

    # LHC likelihoods
    #- capability: lnL_Higgs_invWidth
    #  purpose: LogLike

    # Dark matter likelihoods
    #- capability: lnL_oh2
    #  purpose:    LogLike

    #- capability: lnL_FermiLATdwarfs
    #  purpose:    LogLike

    #- capability: LUX_2013_LogLikelihood
    #  purpose:    LogLike

    # Other observables
    # - purpose:    Observable
    #   capability: RD_oh2

    # - purpose:    Observable
    #   capability: mwimp

    # - purpose:    Observable
    #   capability: sigmav

    # - purpose:    Observable
    #   capability: sigma_SI_p

    # - purpose:    Observable
    #   capability: sigma_SI_n

##############################################################################################
Rules:

  # Choose to implement the relic density likelihood as an upper bound, not a detection
  - capability: lnL_oh2
    function: lnL_oh2_upperlimit
    options:
      oh2_obs: 0.1199
      oh2_obserr: 0.0027

  # Choose to rescale signals in direct and indirect detection by the relic density fraction
  - capability: RD_fraction
    function: RD_fraction_rescaled

  # Use micrOmegas backend function to calculate the relic density
  - capability: RD_oh2
    function: RD_oh2_MicrOmegas
    options:
      fast: 1
      Beps: 1e-5

  # Choose to use detailed Fermi Pass 8 dwarf likelihoood from gamLike
  - capability: lnL_FermiLATdwarfs
    function:  lnL_FermiLATdwarfs_gamLike
    options:
     non_self_conjugate: true

  # Choose to use micrOMEGAs yield tables for indirect detection
  - capability: SimYieldTable
    function: SimYieldTable_MicrOmegas
    options:
      allow_yield_extrapolation: true

  # Use DarkBit's own calculations of the direct detection couplings
  - capability: DD_couplings
    function: DD_couplings_DiracDM

  # Choose to get decays from DecayBit proper, not from an SLHA file.
  - capability: decay_rates
    function: all_decays

  # Choose to get the spectrum from SpecBit proper, not an SLHA file.
  - capability: DiracDM_spectrum
    function: get_DiracDM_spectrum


  # Choose where to take the capture rate from
  - capability: capture_rate_Sun
    function: capture_rate_Sun_const_xsec
    #function: capture_rate_Sun_const_xsec_capgen
    #function: capture_rate_Sun_vnqn
    module: DarkBit

##############################################################################################
Printer:

  printer: hdf5

  options:
    output_file: "DDM_test.hdf5"
    group: "/DDM"
    delete_file_on_restart: true

##############################################################################################
Scanner:
  use_scanner: random

  scanners:

    mn:
      plugin: multinest
      like: LogLike
      nlive: 500
      tol: 0.5

    de:
      plugin: diver
      like: LogLike
      NP: 200
      verbosity: 1
      convthresh: 0.2

    tw:
      plugin: twalk
      sqrtR: 1.001
      chain_number: 512

    random:
      plugin: random
      like:  LogLike
      point_number: 1

##############################################################################################
Logger:

  debug: true

  redirection:
    ["Debug"] : "debug.log"
    [Default] : "default.log"
    [DecayBit] : "DecayBit.log"
    [DarkBit] : "DarkBit.log"
    [PrecisionBit] : "PrecisionBit.log"
    [SpecBit] : "SpecBit.log"
    [Dependency Resolver] : "dep_resolver.log"

##############################################################################################
KeyValues:

  dependency_resolution:
    prefer_model_specific_functions: true

  likelihood:
    model_invalid_for_lnlike_below: -5e5
    model_invalid_for_lnlike_below_alt: -1e5
    debug: true

  default_output_path: "chains/"
