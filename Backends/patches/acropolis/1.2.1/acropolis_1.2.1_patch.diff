diff --git a/acropolis/db.py b/acropolis/db.py
index f1cdae9..6811c3c 100644
--- a/acropolis/db.py
+++ b/acropolis/db.py
@@ -84,6 +84,9 @@ def _get_T_index(T_log):
     # For points at the upper boundary, i+1 does not exist
     return index if index != Tnum - 1 else index - 1
 
+@nb.jit(cache=True)
+def _index_2d(jT, jE):
+    return jT*Enum + jE
 
 @nb.jit(cache=True)
 def interp_rate_db(rate_db, id, E_log, T_log):
@@ -104,7 +107,8 @@ def interp_rate_db(rate_db, id, E_log, T_log):
     xd, yd = (x-x0)/(x1-x0), (y-y0)/(y1-y0)
 
     # Define the index function
-    k = lambda jT, jE: jT*Enum + jE
+    #k = lambda jT, jE: jT*Enum + jE
+    k = _index_2d
 
     c00 = rate_db[ k(iT  , iE  ) ][c]
     c10 = rate_db[ k(iT+1, iE  ) ][c]
@@ -120,6 +124,9 @@ def interp_rate_db(rate_db, id, E_log, T_log):
 
     return 10.**( a0 + a1*x + a2*y + a3*x*y )
 
+@nb.jit(cache=True)
+def _index_3d(jT, jE, jEp):
+    return jT*Enum*(Enum+1)//2 + jE*Enum - (jE-1)*jE//2 + (jEp - jE)
 
 @nb.jit(cache=True)
 def interp_kernel_db(kernel_db, id, E_log, Ep_log, T_log):
@@ -140,7 +147,8 @@ def interp_kernel_db(kernel_db, id, E_log, Ep_log, T_log):
     xd, yd, zd = (x-x0)/(x1-x0), (y-y0)/(y1-y0), (z-z0)/(z1-z0)
 
     # Define the index function
-    k = lambda jT, jE, jEp: jT*Enum*(Enum+1)//2 + jE*Enum - (jE-1)*jE//2 + (jEp - jE)
+    #k = lambda jT, jE, jEp: jT*Enum*(Enum+1)//2 + jE*Enum - (jE-1)*jE//2 + (jEp - jE)
+    k = _index_3d
 
     c000 = kernel_db[ k(iT  , iE  , iEp  ) ][c]
     c100 = kernel_db[ k(iT+1, iE  , iEp  ) ][c]
diff --git a/acropolis/input.py b/acropolis/input.py
--- a/acropolis/input.py	2021-11-04 16:04:57.857595504 +0100
+++ b/acropolis/input.py	2021-11-04 16:05:15.393354618 +0100
@@ -149,6 +149,8 @@ class InputInterface(object):
     def bbn_abundances_0(self):
         return self._sAbundData[:,0]
 
+    def set_bbn_abundances(self, abundances):
+        self._sAbundData = abundances
 
     # 3. PARAM_DATA ###########################################################
 
