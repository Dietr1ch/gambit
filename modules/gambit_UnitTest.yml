# Minimal GAMBIT DarkBit test initialization file (in YAML)
 
###################################
# Input parameter declarations
###################################

Parameters: 
    StandardModel_SLHA2: !import StandardModel_SLHA2_defaults.yaml
  #MSSM25atQ: !import LesHouches.in.MSSM_1.yaml
    MSSM25atQ:
      Qin:
        fixed_value: 1.9422e+16
      SignMu:
        fixed_value: 1
      TanBeta:
        fixed_value: 10
      mHu2:
        fixed_value: 15625
      mHd2:
        fixed_value: 15625
      M1:
        fixed_value: 500
      M2:
        fixed_value: 500
      M3:
        fixed_value: 500
      mq2_1:
        fixed_value: 15625.0
      mq2_2:
        fixed_value: 15625.0
      mq2_3:
        fixed_value: 15625.0
      ml2_1:
        fixed_value: 15625.0
      ml2_2:
        fixed_value: 15625.0
      ml2_3:
        fixed_value: 15625.0
      md2_1:
        fixed_value: 15625.0
      md2_2:
        fixed_value: 15625.0
      md2_3:
        fixed_value: 15625.0
      mu2_1:
        fixed_value: 15625.0
      mu2_2:
        fixed_value: 15625.0
      mu2_3:
        fixed_value: 15625.0
      me2_1:
        fixed_value: 15625.0
      me2_2:
        fixed_value: 15625.0
      me2_3:
        fixed_value: 15625.0
      Ae_12:
        fixed_value: 0
      Ae_3:
        fixed_value: 0
      Ad_3:
        fixed_value: 0
      Au_3:
        fixed_value: 0

    nuclear_params_fnq:
      # proton hadronic matrix elements
      fpd:
        fixed_value: 0.0191
      fpu:
        fixed_value: 0.0153
      fps:
        fixed_value: 0.0447
      # neutron hadronic matrix elements
      fnd:
        fixed_value: 0.0273
      fnu:
        fixed_value: 0.011
      fns:
        fixed_value: 0.0447
      # proton spin content
      deltad:
        fixed_value: -0.427
      deltau:
        fixed_value: 0.842
      deltas:
        fixed_value: -0.085

##############################
# Prior setup
##############################

Priors:


##############################
# Printer setup
##############################

Printer:

  # Select printer to use via string tag
  # (currently only ascii printer available)
  printer: ascii

  # This options node is passed on wholesale to
  # the printer object; required options may
  # therefore vary according to the selected
  # printer. 
  options:
    # name of output file
    output_file: "runs/DarkBit_UnitTest/samples/gambit_output.txt"
    # name of info file (explains content of output file)
    info_file: "runs/DarkBit_UnitTest/samples/gambit_output.info"

##############################
# Scanner setup
##############################

Scanner:
  use_scanner: toy_mcmc
  
  scanners:
    toy_mcmc:
      point_number: 2
      output_file:  output
      like:  Likelihood

    nested:
      plugin: MultiNest
      nlive: 500
      tol: 0.1
      output_file:  output
    

###############################
# Observables of interest
###############################

ObsLikes:
    - capability: UnitTest_DarkBit


Rules:
  - capability: A0_decay_rates
    function: A0_decays
  - capability: Higgs_decay_rates
    function: MSSM_h0_1_decays
  - capability: Hplus_decay_rates
    function: Hplus_decays
  - capability: h0_2_decay_rates
    function: h0_2_decays
  - capability: t_decay_rates
    function: t_decays

  - capability: MSSM_spectrum 
  #  function: get_MSSMatMGUT_spectrum  # Use this function to compute this capability
    options:
      # Set to match benchmark point specified in
      # SpecBit/MSSM_benchmark_points/LesHouches.in.MSSM_1
      precision_goal:        1.0e-4
      max_iterations:        0
      calculate_sm_masses:   false
      pole_mass_loop_order:  2
      ewsb_loop_order:       2
      beta_loop_order:       2
      threshold_corrections_loop_order: 1
      use_higgs_2loop_at_as: true
      use_higgs_2loop_ab_as: true
      use_higgs_2loop_at_at: true
      use_higgs_2loop_atau_atau: true
      invalid_point_fatal: false


#  - capability: RD_thresholds_resonances
#    function:  RD_thresholds_resonances_from_spectrum
#  - capability: DarkSUSY_PointInit
#    options:
#      show_higgs_widths: true
#  - capability: GA_missingFinalStates
#    options:
#      ignore_three_body: True
#      ignore_two_body: True
#  - capability: TH_ProcessCatalog
#    options:
#      ignore_three_body: False
#  - capability: GA_AnnYield
#    function: GA_AnnYield_General
  - module: DarkBit
    options: 
        # Cascade decay settings
        cMC_maxChainLength:     -1    # Maximum length of decay chains. -1 => disabled
        cMC_Emin:               -1.   # Ignore all particles with energies below this value. value < 0 => disabled
        cMC_minEvents:          100  # Minimum number of decay chains to generate
        cMC_maxEvents:          10000 # Maximum number of decay chains to generate
        cMC_endCheckFrequency:  25    # Check end condition every this many events
        cMC_gammaRelError:      0.01  # Gamma ray end condition for event generation, relative error.      
        cMC_gammaBGPower:       -2.5  # Gamma spectrum power used in gamma ray end condition
        cMC_minSpecSamples:     5     # Minimum number of samples to use when sampling tabulated spectra from decay chain endpoints like q qbar
        cMC_maxSpecSamples:     100   # As above, maximum number.
        cMC_specValidThreshold: 1e-20 # Only accept a sampled spectrum value if it's above this threshold. Use carefully, as high values will give a biased sample.
        cMC_finalStates:              # List of final states to search for in cascade decays
            - gamma

  - capability: RD_thresholds_resonances
    function:  RD_thresholds_resonances_from_spectrum
  - capability: DarkSUSY_PointInit
    options:
      show_higgs_widths: true
      debug_SLHA_filenames:
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_co.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_100.slha
            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_200.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_300.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/FMCp03000765.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE56C_003717.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE58D_007879.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67B_006998.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67D_001840.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE87O_006600.slha
  - capability: GA_missingFinalStates
    options:
      ignore_three_body: false
      ignore_two_body: false
  - capability: TH_ProcessCatalog
    options:
      ignore_three_body: false
  - capability: GA_AnnYield
    function: GA_AnnYield_General
    options:
      debug_dump_spectra: true
      debug_spectrum_file: DarkBit/MSSM_debug_spectrum.yml
  - capability: SimYieldTable
    function: SimYieldTable_DarkSusy
#    #function: SimYieldTable_MicrOmegas
  - capability: UnitTest_DarkBit
    dependencies:
        - capability: RD_oh2
          function: RD_oh2_general
#        - capability: DD_couplings
#          function: DD_couplings_DarkSUSY
#          #function: DD_couplings_MicrOmegas
#          function: RD_oh2_DarkSUSY
#          #function: RD_oh2_MicrOmegas
#    options:
#        fileroot: UnitTest_MSSMbenchmarks_DarkSUSY
#        #fileroot: UnitTest_MSSMbenchmarks_MicrOmegas
#        GA_AnnYield:
#          nbins: 100

#  - capability: MSSM_spectrum
#    function: get_MSSM_spectrum_from_SLHAfile # For unit test: reads in spectrum from SLHA file
#    module: SpecBit
#    options:
#        filenames: 
  - capability: MSSM_spectrum
#    function: get_MSSM_spectrum_from_SLHAfile # For unit test: reads in spectrum from SLHA file
#    module: SpecBit
#    options:
#        filenames: 
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_co.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_100.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_200.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_300.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/FMCp03000765.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE56C_003717.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE58D_007879.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67B_006998.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67D_001840.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE87O_006600.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/FMCp03000765.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE56C_003717.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE58D_007879.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67B_006998.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67D_001840.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE87O_006600.slha

  - function: SUSY_HIT_1_5_init
    options:
      debug_SLHA_files:
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_co.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_100.slha
            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_200.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_300.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/FMCp03000765.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE56C_003717.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE58D_007879.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67B_006998.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67D_001840.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE87O_006600.slha

#  - capability: MSSM_spectrum
#    function: get_MSSM_spectrum_from_file  # For unit test: reads in spectrum from SLHA file
#    module: DarkBit
#    options:
#        filenames: 
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_co.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_100.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_200.slha
#            - DarkBit/slha-benchmarks/01-01-2013_torsten/test_300.slha
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/FMCp03000765.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE56C_003717.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE58D_007879.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67B_006998.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE67D_001840.slha1
#            - DarkBit/slha-benchmarks/14-12-2014_joakim/JE87O_006600.slha1

#  - capability: RD_oh2
#    options:
#      fast: 1  # Accuracy options (used by MicrOmegas)
#      Beps: 1e-2
#      omtype: 0
#  - capability: RD_spectrum
#    options: 
#      CoannMaxMass: 1.01 # include only co-annihilating particles up to this mass


#########################
# Logging setup
#########################

Logger:

  # Redirection of specific messages according to tags
  # Can redirect to stdout or stderr by specifying these as the "filenames". 
  # Obviously this also means it is impossible to redirect output to actual
  # files with these names.

  prefix : "runs/DarkBit_minimalTest/logs/"
  redirection:
    [Debug] : "debug.log"
    [Default] : "stdout" #"default.log"
    [Error] : "errors.log"
    [Warning] : "warnings.log"
    [Core,Error] : "core_errors.log"
    [Core,Error,Fatal] : "fatal_core_errors.log"
    [Dependency Resolver] : "stdout"
    [ExampleBit_A] : "ExampleBit_A.log"
    [ExampleBit_B] : "ExampleBit_B.log"
    [BackendIniBit]: "BackendIniBit.log"
    [LibFirst] : "libfirst.log"
  #  [Logger, Debug] : "stdout"
  #  [Core] : "stdout"
  #  [Dependency Resolver] : "stdout"

##########################
# Name/Value Section
##########################

KeyValues:

  dependency_resolution:
    prefer_model_specific_functions: true
    use_old_routines: false

  likelihood:
    model_invalid_for_lnlike_below: -1e6

  #By default, errors are fatal and warnings non-fatal
  exceptions:
    dependency_resolver_error: fatal
    dependency_resolver_warning: non-fatal
    core_warning: fatal
    scan_error: fatal

  enable_testing: false

